--- stp_print_OLD.c	2021-12-07 00:03:43.204054600 +0800
+++ stp_print_NEW.c	2021-12-07 00:03:43.204054600 +0800
@@ -76,6 +76,7 @@
             if (stp_bpdu->protocol_version == STP_PROTO_SPB)
             {
               /* Validate v4 length */
+              ND_TCHECK_16BITS(p + MST_BPDU_VER3_LEN_OFFSET + mstp_len);
               spb_len = EXTRACT_16BITS (p + MST_BPDU_VER3_LEN_OFFSET + mstp_len);
               spb_len += 2;
               if (length < (sizeof(struct stp_bpdu_) + mstp_len + spb_len) ||
