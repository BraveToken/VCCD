--- BN_dec2bn_OLD.c	2021-12-06 23:52:20.917935000 +0800
+++ BN_dec2bn_NEW.c	2021-12-06 23:52:20.918932900 +0800
@@ -12,7 +12,11 @@
         a++;
     }
 
-    for (i = 0; isdigit((unsigned char)a[i]); i++) ;
+    for (i = 0; i <= (INT_MAX/4) && isdigit((unsigned char)a[i]); i++)
+        continue;
+
+    if (i > INT_MAX/4)
+        goto err;
 
     num = i + neg;
     if (bn == NULL)
@@ -30,7 +34,7 @@
         BN_zero(ret);
     }
 
-    /* i is the number of digests, a bit of an over expand; */
+    /* i is the number of digits, a bit of an over expand */
     if (bn_expand(ret, i * 4) == NULL)
         goto err;
 
