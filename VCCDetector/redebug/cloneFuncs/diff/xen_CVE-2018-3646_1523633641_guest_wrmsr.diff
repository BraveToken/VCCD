--- guest_wrmsr_OLD.c	2021-12-07 00:17:17.836246800 +0800
+++ guest_wrmsr_NEW.c	2021-12-07 00:17:17.837269000 +0800
@@ -65,6 +65,17 @@
             wrmsrl(MSR_PRED_CMD, val);
         break;
 
+    case MSR_FLUSH_CMD:
+        if ( !cp->feat.l1d_flush )
+            goto gp_fault; /* MSR available? */
+
+        if ( val & ~FLUSH_CMD_L1D )
+            goto gp_fault; /* Rsvd bit set? */
+
+        if ( v == curr )
+            wrmsrl(MSR_FLUSH_CMD, val);
+        break;
+
     case MSR_INTEL_MISC_FEATURES_ENABLES:
     {
         bool old_cpuid_faulting = msrs->misc_features_enables.cpuid_faulting;
