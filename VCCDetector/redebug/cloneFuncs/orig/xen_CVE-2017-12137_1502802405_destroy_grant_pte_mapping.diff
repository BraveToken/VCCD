--- destroy_grant_pte_mapping_OLD.c	2021-12-07 00:16:08.915604200 +0800
+++ destroy_grant_pte_mapping_NEW.c	2021-12-07 00:16:08.915604200 +0800
@@ -7,6 +7,16 @@
     struct page_info *page;
     l1_pgentry_t ol1e;
 
+    /*
+     * addr comes from Xen's active_entry tracking so isn't guest controlled,
+     * but it had still better be PTE-aligned.
+     */
+    if ( !IS_ALIGNED(addr, sizeof(ol1e)) )
+    {
+        ASSERT_UNREACHABLE();
+        return GNTST_general_error;
+    }
+
     gmfn = addr >> PAGE_SHIFT;
     page = get_page_from_gfn(d, gmfn, NULL, P2M_ALLOC);
 
