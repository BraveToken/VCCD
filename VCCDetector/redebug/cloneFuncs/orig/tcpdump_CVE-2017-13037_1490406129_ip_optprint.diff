--- ip_optprint_OLD.c	2021-12-07 00:06:37.394202300 +0800
+++ ip_optprint_NEW.c	2021-12-07 00:06:37.395201500 +0800
@@ -42,7 +42,8 @@
 			return;
 
 		case IPOPT_TS:
-			ip_printts(ndo, cp, option_len);
+			if (ip_printts(ndo, cp, option_len) == -1)
+				goto trunc;
 			break;
 
 		case IPOPT_RR:       /* fall through */
