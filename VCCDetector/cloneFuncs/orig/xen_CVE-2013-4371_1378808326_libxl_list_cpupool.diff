--- libxl_list_cpupool_OLD.c	2021-12-07 00:11:22.963414400 +0800
+++ libxl_list_cpupool_NEW.c	2021-12-07 00:11:22.964407700 +0800
@@ -15,6 +15,7 @@
         if (!tmp) {
             LIBXL__LOG_ERRNO(ctx, LIBXL__LOG_ERROR, "allocating cpupool info");
             libxl_cpupoolinfo_list_free(ptr, i);
+            ptr = NULL;
             goto out;
         }
         ptr = tmp;
