--- bgp_attr_print_OLD.c	2021-12-07 00:04:36.812672800 +0800
+++ bgp_attr_print_NEW.c	2021-12-07 00:04:36.812672800 +0800
@@ -58,6 +58,7 @@
 			ND_TCHECK(tptr[0]);
                         ND_PRINT((ndo, "%s", tok2str(bgp_as_path_segment_open_values,
 						"?", tptr[0])));
+			ND_TCHECK(tptr[1]);
                         for (i = 0; i < tptr[1] * as_size; i += as_size) {
                             ND_TCHECK2(tptr[2 + i], as_size);
 			    ND_PRINT((ndo, "%s ",
