--- dtls1_process_out_of_seq_message_OLD.c	2021-12-06 23:50:11.199857100 +0800
+++ dtls1_process_out_of_seq_message_NEW.c	2021-12-06 23:50:11.199857100 +0800
@@ -47,6 +47,9 @@
 		if (frag_len && frag_len < msg_hdr->msg_len)
 			return dtls1_reassemble_fragment(s, msg_hdr, ok);
 
+		if (frag_len > dtls1_max_handshake_message_len(s))
+			goto err;
+
 		frag = dtls1_hm_fragment_new(frag_len, 0);
 		if ( frag == NULL)
 			goto err;
