--- keyctl_join_session_keyring_OLD.c	2021-12-06 23:38:16.160271100 +0800
+++ keyctl_join_session_keyring_NEW.c	2021-12-06 23:38:16.161268300 +0800
@@ -11,12 +11,16 @@
 			ret = PTR_ERR(name);
 			goto error;
 		}
+
+		ret = -EPERM;
+		if (name[0] == '.')
+			goto error_name;
 	}
 
 	/* join the session */
 	ret = join_session_keyring(name);
+error_name:
 	kfree(name);
-
 error:
 	return ret;
 }
