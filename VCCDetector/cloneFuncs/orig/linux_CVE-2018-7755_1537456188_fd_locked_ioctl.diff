--- fd_locked_ioctl_OLD.c	2021-12-06 23:43:12.715108000 +0800
+++ fd_locked_ioctl_NEW.c	2021-12-06 23:43:12.715108000 +0800
@@ -79,6 +79,9 @@
 					  (struct floppy_struct **)&outparam);
 		if (ret)
 			return ret;
+		memcpy(&inparam.g, outparam,
+				offsetof(struct floppy_struct, name));
+		outparam = &inparam.g;
 		break;
 	case FDMSGON:
 		UDP->flags |= FTD_MSG;
