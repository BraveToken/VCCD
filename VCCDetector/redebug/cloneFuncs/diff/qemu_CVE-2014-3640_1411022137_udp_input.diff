--- udp_input_OLD.c	2021-12-06 23:57:39.218596100 +0800
+++ udp_input_NEW.c	2021-12-06 23:57:39.219589000 +0800
@@ -89,7 +89,7 @@
 	 * Locate pcb for datagram.
 	 */
 	so = slirp->udp_last_so;
-	if (so->so_lport != uh->uh_sport ||
+	if (so == &slirp->udb || so->so_lport != uh->uh_sport ||
 	    so->so_laddr.s_addr != ip->ip_src.s_addr) {
 		struct socket *tmp;
 
