--- tipc_data_input_OLD.c	2021-12-06 23:47:36.851651000 +0800
+++ tipc_data_input_NEW.c	2021-12-06 23:47:36.851651000 +0800
@@ -31,8 +31,11 @@
 		return false;
 #ifdef CONFIG_TIPC_CRYPTO
 	case MSG_CRYPTO:
-		tipc_crypto_msg_rcv(l->net, skb);
-		return true;
+		if (TIPC_SKB_CB(skb)->decrypted) {
+			tipc_crypto_msg_rcv(l->net, skb);
+			return true;
+		}
+		fallthrough;
 #endif
 	default:
 		pr_warn("Dropping received illegal msg type\n");
