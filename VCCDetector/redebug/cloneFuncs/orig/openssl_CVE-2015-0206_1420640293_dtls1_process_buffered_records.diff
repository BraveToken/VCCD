--- dtls1_process_buffered_records_OLD.c	2021-12-06 23:51:06.292528400 +0800
+++ dtls1_process_buffered_records_NEW.c	2021-12-06 23:51:06.293507700 +0800
@@ -16,8 +16,9 @@
             dtls1_get_unprocessed_record(s);
             if ( ! dtls1_process_record(s))
                 return(0);
-            dtls1_buffer_record(s, &(s->d1->processed_rcds), 
-                s->s3->rrec.seq_num);
+            if(dtls1_buffer_record(s, &(s->d1->processed_rcds),
+                s->s3->rrec.seq_num)<0)
+                return -1;
             }
         }
 
