--- h264_set_parameter_from_sps_OLD.c	2021-12-06 23:20:10.293556100 +0800
+++ h264_set_parameter_from_sps_NEW.c	2021-12-06 23:20:10.293556100 +0800
@@ -13,6 +13,12 @@
     if (h->avctx->has_b_frames < 2)
         h->avctx->has_b_frames = !h->low_delay;
 
+    if (h->sps.bit_depth_luma != h->sps.bit_depth_chroma) {
+        av_log_missing_feature(h->avctx,
+            "Different bit depth between chroma and luma", 1);
+        return AVERROR_PATCHWELCOME;
+    }
+
     if (h->avctx->bits_per_raw_sample != h->sps.bit_depth_luma ||
         h->cur_chroma_format_idc      != h->sps.chroma_format_idc) {
         if (h->avctx->codec &&
