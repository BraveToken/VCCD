--- v3_addr_get_range_OLD.c	2021-12-06 23:48:49.153300800 +0800
+++ v3_addr_get_range_NEW.c	2021-12-06 23:48:49.154290700 +0800
@@ -8,8 +8,9 @@
   if (aor == NULL || min == NULL || max == NULL ||
       afi_length == 0 || length < afi_length ||
       (aor->type != IPAddressOrRange_addressPrefix &&
-       aor->type != IPAddressOrRange_addressRange))
+       aor->type != IPAddressOrRange_addressRange) ||
+      !extract_min_max(aor, min, max, afi_length))
     return 0;
-  extract_min_max(aor, min, max, afi_length);
+
   return afi_length;
 }
