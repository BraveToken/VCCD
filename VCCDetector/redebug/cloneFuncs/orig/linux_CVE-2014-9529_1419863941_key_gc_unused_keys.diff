--- key_gc_unused_keys_OLD.c	2021-12-06 23:36:05.382049400 +0800
+++ key_gc_unused_keys_NEW.c	2021-12-06 23:36:05.382049400 +0800
@@ -22,12 +22,12 @@
 		if (test_bit(KEY_FLAG_INSTANTIATED, &key->flags))
 			atomic_dec(&key->user->nikeys);
 
-		key_user_put(key->user);
-
 		/* now throw away the key memory */
 		if (key->type->destroy)
 			key->type->destroy(key);
 
+		key_user_put(key->user);
+
 		kfree(key->description);
 
 #ifdef KEY_DEBUGGING
