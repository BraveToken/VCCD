--- BIO_vsnprintf_OLD.c	2021-12-06 23:52:31.588375600 +0800
+++ BIO_vsnprintf_NEW.c	2021-12-06 23:52:31.588375600 +0800
@@ -3,7 +3,8 @@
     size_t retlen;
     int truncated;
 
-    _dopr(&buf, NULL, &n, &retlen, &truncated, format, args);
+    if(!_dopr(&buf, NULL, &n, &retlen, &truncated, format, args))
+        return -1;
 
     if (truncated)
         /*
