--- get_page_and_type_from_pagenr_OLD.c	2021-12-07 00:10:15.171700700 +0800
+++ get_page_and_type_from_pagenr_NEW.c	2021-12-07 00:10:15.171700700 +0800
@@ -15,7 +15,8 @@
           get_page_type_preemptible(page, type) :
           (get_page_type(page, type) ? 0 : -EINVAL));
 
-    if ( unlikely(rc) && partial >= 0 )
+    if ( unlikely(rc) && partial >= 0 &&
+         (!preemptible || page != current->arch.old_guest_table) )
         put_page(page);
 
     return rc;
