--- ethertype_print_OLD.c	2021-12-07 00:02:55.685176400 +0800
+++ ethertype_print_NEW.c	2021-12-07 00:02:55.686173700 +0800
@@ -39,7 +39,11 @@
 		return (1);
 
 	case ETHERTYPE_ISO:
-		isoclns_print(ndo, p + 1, length - 1, length - 1);
+		if (length == 0 || caplen == 0) {
+			ND_PRINT((ndo, " [|osi]"));
+			return (1);
+		}
+		isoclns_print(ndo, p + 1, length - 1, caplen - 1);
 		return(1);
 
 	case ETHERTYPE_PPPOED:
