--- ac3_decode_frame_OLD.c	2021-12-06 23:19:42.606571200 +0800
+++ ac3_decode_frame_NEW.c	2021-12-06 23:19:42.606571200 +0800
@@ -105,6 +105,7 @@
         avctx->audio_service_type = AV_AUDIO_SERVICE_TYPE_KARAOKE;
 
     /* get output buffer */
+    avctx->channels = s->out_channels;
     s->frame.nb_samples = s->num_blocks * 256;
     if ((ret = avctx->get_buffer(avctx, &s->frame)) < 0) {
         av_log(avctx, AV_LOG_ERROR, "get_buffer() failed\n");
