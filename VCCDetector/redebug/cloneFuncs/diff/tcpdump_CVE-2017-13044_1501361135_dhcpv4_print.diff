--- dhcpv4_print_OLD.c	2021-12-07 00:07:02.162944600 +0800
+++ dhcpv4_print_NEW.c	2021-12-07 00:07:02.162944600 +0800
@@ -8,6 +8,8 @@
 
     i = 0;
     while (i < length) {
+        if (i + 2 > length)
+            return -1;
         tlv = cp + i;
         type = (uint8_t)tlv[0];
         optlen = (uint8_t)tlv[1];
@@ -19,6 +21,8 @@
 
         ND_PRINT((ndo, "%s", tok2str(dh4opt_str, "Unknown", type)));
         ND_PRINT((ndo," (%u)", optlen + 2 ));
+        if (i + 2 + optlen > length)
+            return -1;
 
         switch (type) {
         case DH4OPT_DNS_SERVERS:
