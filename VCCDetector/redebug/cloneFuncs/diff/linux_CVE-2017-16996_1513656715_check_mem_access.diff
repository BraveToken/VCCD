--- check_mem_access_OLD.c	2021-12-06 23:39:23.567982800 +0800
+++ check_mem_access_NEW.c	2021-12-06 23:39:23.567982800 +0800
@@ -125,9 +125,7 @@
 	if (!err && size < BPF_REG_SIZE && value_regno >= 0 && t == BPF_READ &&
 	    regs[value_regno].type == SCALAR_VALUE) {
 		/* b/h/w load zero-extends, mark upper bits as known 0 */
-		regs[value_regno].var_off =
-			tnum_cast(regs[value_regno].var_off, size);
-		__update_reg_bounds(&regs[value_regno]);
+		coerce_reg_to_size(&regs[value_regno], size);
 	}
 	return err;
 }
