--- nvme_changed_nslist_OLD.c	2021-12-07 00:02:42.244120500 +0800
+++ nvme_changed_nslist_NEW.c	2021-12-07 00:02:42.244120500 +0800
@@ -6,6 +6,11 @@
     int i = 0;
     uint32_t nsid;
 
+    if (off >= sizeof(nslist)) {
+        trace_pci_nvme_err_invalid_log_page_offset(off, sizeof(nslist));
+        return NVME_INVALID_FIELD | NVME_DNR;
+    }
+
     memset(nslist, 0x0, sizeof(nslist));
     trans_len = MIN(sizeof(nslist) - off, buf_len);
 
