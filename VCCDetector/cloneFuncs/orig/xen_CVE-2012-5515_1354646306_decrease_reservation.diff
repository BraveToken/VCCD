--- decrease_reservation_OLD.c	2021-12-07 00:09:46.309918900 +0800
+++ decrease_reservation_NEW.c	2021-12-07 00:09:46.309918900 +0800
@@ -4,7 +4,8 @@
     xen_pfn_t gmfn;
 
     if ( !guest_handle_subrange_okay(a->extent_list, a->nr_done,
-                                     a->nr_extents-1) )
+                                     a->nr_extents-1) ||
+         a->extent_order > MAX_ORDER )
         return;
 
     for ( i = a->nr_done; i < a->nr_extents; i++ )
