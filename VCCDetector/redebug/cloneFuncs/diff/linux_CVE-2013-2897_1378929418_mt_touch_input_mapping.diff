--- mt_touch_input_mapping_OLD.c	2021-12-06 23:33:31.779872000 +0800
+++ mt_touch_input_mapping_NEW.c	2021-12-06 23:33:31.779872000 +0800
@@ -108,6 +108,10 @@
 			mt_store_field(usage, td, hi);
 			return 1;
 		case HID_DG_CONTACTCOUNT:
+			/* Ignore if indexes are out of bounds. */
+			if (field->index >= field->report->maxfield ||
+			    usage->usage_index >= field->report_count)
+				return 1;
 			td->cc_index = field->index;
 			td->cc_value_index = usage->usage_index;
 			return 1;
