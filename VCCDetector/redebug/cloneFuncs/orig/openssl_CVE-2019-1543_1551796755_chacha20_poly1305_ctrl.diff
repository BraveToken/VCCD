--- chacha20_poly1305_ctrl_OLD.c	2021-12-06 23:54:14.818253200 +0800
+++ chacha20_poly1305_ctrl_NEW.c	2021-12-06 23:54:14.818253200 +0800
@@ -36,7 +36,7 @@
         return 1;
 
     case EVP_CTRL_AEAD_SET_IVLEN:
-        if (arg <= 0 || arg > CHACHA_CTR_SIZE)
+        if (arg <= 0 || arg > CHACHA20_POLY1305_MAX_IVLEN)
             return 0;
         actx->nonce_len = arg;
         return 1;
