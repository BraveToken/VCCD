--- atalk_print_OLD.c	2021-12-07 00:03:26.397006700 +0800
+++ atalk_print_NEW.c	2021-12-07 00:03:26.398028200 +0800
@@ -8,6 +8,10 @@
         if(!ndo->ndo_eflag)
             ND_PRINT((ndo, "AT "));
 
+	if (!ND_TTEST2(*bp, ddpSize)) {
+		ND_PRINT((ndo, " [|ddp]"));
+		return;
+	}
 	if (length < ddpSize) {
 		ND_PRINT((ndo, " [|ddp %u]", length));
 		return;
