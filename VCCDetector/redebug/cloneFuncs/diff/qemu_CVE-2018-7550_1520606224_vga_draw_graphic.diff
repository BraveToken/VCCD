--- vga_draw_graphic_OLD.c	2021-12-07 00:01:25.788604700 +0800
+++ vga_draw_graphic_NEW.c	2021-12-07 00:01:25.788604700 +0800
@@ -24,6 +24,8 @@
 
     region_start = (s->start_addr * 4);
     region_end = region_start + (ram_addr_t)s->line_offset * height;
+    region_end += width * s->get_bpp(s) / 8; /* scanline length */
+    region_end -= s->line_offset;
     if (region_end > s->vbe_size) {
         /* wraps around (can happen with cirrus vbe modes) */
         region_start = 0;
