--- ssl3_send_client_key_exchange_OLD.c	2021-12-06 23:50:29.086018600 +0800
+++ ssl3_send_client_key_exchange_NEW.c	2021-12-06 23:50:29.087015700 +0800
@@ -33,6 +33,13 @@
 			RSA *rsa;
 			unsigned char tmp_buf[SSL_MAX_MASTER_KEY_LENGTH];
 
+			if (s->session->sess_cert == NULL)
+				{
+				/* We should always have a server certificate with SSL_kRSA. */
+				SSLerr(SSL_F_SSL3_SEND_CLIENT_KEY_EXCHANGE,ERR_R_INTERNAL_ERROR);
+				goto err;
+				}
+
 			if (s->session->sess_cert->peer_rsa_tmp != NULL)
 				rsa=s->session->sess_cert->peer_rsa_tmp;
 			else
