--- selinux_setprocattr_OLD.c	2021-12-06 23:39:42.215109200 +0800
+++ selinux_setprocattr_NEW.c	2021-12-06 23:39:42.215109200 +0800
@@ -34,7 +34,7 @@
 		return error;
 
 	/* Obtain a SID for the context, if one was specified. */
-	if (size && str[1] && str[1] != '\n') {
+	if (size && str[0] && str[0] != '\n') {
 		if (str[size-1] == '\n') {
 			str[size-1] = 0;
 			size--;
