--- ff_ivi_decode_frame_OLD.c	2021-12-06 23:22:43.673291800 +0800
+++ ff_ivi_decode_frame_NEW.c	2021-12-06 23:22:43.673291800 +0800
@@ -16,6 +16,8 @@
                "Error while decoding picture header: %d\n", result);
         return -1;
     }
+    if (ctx->gop_invalid)
+        return AVERROR_INVALIDDATA;
 
     if (ctx->gop_flags & IVI5_IS_PROTECTED) {
         av_log(avctx, AV_LOG_ERROR, "Password-protected clip!\n");
