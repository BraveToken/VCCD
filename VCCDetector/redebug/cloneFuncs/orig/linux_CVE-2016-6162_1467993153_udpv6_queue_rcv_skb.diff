--- udpv6_queue_rcv_skb_OLD.c	2021-12-06 23:37:39.661889100 +0800
+++ udpv6_queue_rcv_skb_NEW.c	2021-12-06 23:37:39.661889100 +0800
@@ -65,6 +65,8 @@
 
 	if (sk_filter(sk, skb))
 		goto drop;
+	if (unlikely(skb->len < sizeof(struct udphdr)))
+		goto drop;
 
 	udp_csum_pull_header(skb);
 	if (sk_rcvqueues_full(sk, sk->sk_rcvbuf)) {
