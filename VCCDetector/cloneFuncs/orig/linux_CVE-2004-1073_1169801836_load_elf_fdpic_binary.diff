--- load_elf_fdpic_binary_OLD.c	2021-12-06 23:27:43.860414200 +0800
+++ load_elf_fdpic_binary_NEW.c	2021-12-06 23:27:43.860414200 +0800
@@ -70,6 +70,14 @@
 				goto error;
 			}
 
+			/*
+			 * If the binary is not readable then enforce
+			 * mm->dumpable = 0 regardless of the interpreter's
+			 * permissions.
+			 */
+			if (file_permission(interpreter, MAY_READ) < 0)
+				bprm->interp_flags |= BINPRM_FLAGS_ENFORCE_NONDUMP;
+
 			retval = kernel_read(interpreter, 0, bprm->buf,
 					     BINPRM_BUF_SIZE);
 			if (retval < 0)
