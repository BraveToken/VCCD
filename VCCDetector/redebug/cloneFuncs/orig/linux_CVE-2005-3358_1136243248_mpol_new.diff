--- mpol_new_OLD.c	2021-12-06 23:27:51.163881100 +0800
+++ mpol_new_NEW.c	2021-12-06 23:27:51.163881100 +0800
@@ -12,6 +12,10 @@
 	switch (mode) {
 	case MPOL_INTERLEAVE:
 		policy->v.nodes = *nodes;
+		if (nodes_weight(*nodes) == 0) {
+			kmem_cache_free(policy_cache, policy);
+			return ERR_PTR(-EINVAL);
+		}
 		break;
 	case MPOL_PREFERRED:
 		policy->v.preferred_node = first_node(*nodes);
