--- cirrus_bitblt_common_patterncopy_OLD.c	2021-12-06 23:54:51.728557500 +0800
+++ cirrus_bitblt_common_patterncopy_NEW.c	2021-12-06 23:54:51.729559100 +0800
@@ -3,7 +3,11 @@
 {
     uint8_t *dst;
 
-    dst = s->vram_ptr + s->cirrus_blt_dstaddr;
+    dst = s->vram_ptr + (s->cirrus_blt_dstaddr & s->cirrus_addr_mask);
+
+    if (BLTUNSAFE(s))
+        return 0;
+
     (*s->cirrus_rop) (s, dst, src,
                       s->cirrus_blt_dstpitch, 0,
                       s->cirrus_blt_width, s->cirrus_blt_height);
