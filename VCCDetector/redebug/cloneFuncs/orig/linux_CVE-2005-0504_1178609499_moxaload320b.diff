--- moxaload320b_OLD.c	2021-12-06 23:27:47.599413900 +0800
+++ moxaload320b_NEW.c	2021-12-06 23:27:47.599413900 +0800
@@ -3,7 +3,7 @@
 	void __iomem *baseAddr;
 	int i;
 
-	if(len > sizeof(moxaBuff))
+	if(len < 0 || len > sizeof(moxaBuff))
 		return -EINVAL;
 	if(copy_from_user(moxaBuff, tmp, len))
 		return -EFAULT;
