--- CRYPTO_realloc_clean_OLD.c	2021-12-06 23:49:09.247554000 +0800
+++ CRYPTO_realloc_clean_NEW.c	2021-12-06 23:49:09.247554000 +0800
@@ -8,6 +8,10 @@
 
 	if (num <= 0) return NULL;
 
+	/* We don't support shrinking the buffer. Note the memcpy that copies
+	 * |old_len| bytes to the new buffer, below. */
+	if (num < old_len) return NULL;
+
 	if (realloc_debug_func != NULL)
 		realloc_debug_func(str, NULL, num, file, line, 0);
 	ret=malloc_ex_func(num,file,line);
