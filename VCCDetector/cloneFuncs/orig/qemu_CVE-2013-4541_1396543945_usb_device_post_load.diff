--- usb_device_post_load_OLD.c	2021-12-06 23:56:37.063832000 +0800
+++ usb_device_post_load_NEW.c	2021-12-06 23:56:37.063832000 +0800
@@ -7,7 +7,9 @@
     } else {
         dev->attached = 1;
     }
-    if (dev->setup_index >= sizeof(dev->data_buf) ||
+    if (dev->setup_index < 0 ||
+        dev->setup_len < 0 ||
+        dev->setup_index >= sizeof(dev->data_buf) ||
         dev->setup_len >= sizeof(dev->data_buf)) {
         return -EINVAL;
     }
