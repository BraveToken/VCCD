--- SSL_get_shared_ciphers_OLD.c	2021-12-06 23:47:50.656728900 +0800
+++ SSL_get_shared_ciphers_NEW.c	2021-12-06 23:47:50.656728900 +0800
@@ -19,7 +19,7 @@
 		c=sk_SSL_CIPHER_value(sk,i);
 		for (cp=c->name; *cp; )
 			{
-			if (len-- == 0)
+			if (len-- <= 0)
 				{
 				*p='\0';
 				return(buf);
