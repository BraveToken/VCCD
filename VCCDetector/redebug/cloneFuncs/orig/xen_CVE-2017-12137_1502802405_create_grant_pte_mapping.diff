--- create_grant_pte_mapping_OLD.c	2021-12-07 00:16:08.860761100 +0800
+++ create_grant_pte_mapping_NEW.c	2021-12-07 00:16:08.860761100 +0800
@@ -8,6 +8,9 @@
     l1_pgentry_t ol1e;
     struct domain *d = v->domain;
 
+    if ( !IS_ALIGNED(pte_addr, sizeof(nl1e)) )
+        return GNTST_general_error;
+
     adjust_guest_l1e(nl1e, d);
 
     gmfn = pte_addr >> PAGE_SHIFT;
