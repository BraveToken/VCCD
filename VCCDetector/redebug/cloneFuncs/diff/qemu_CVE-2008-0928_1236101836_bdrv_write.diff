--- bdrv_write_OLD.c	2021-12-06 23:54:59.569587000 +0800
+++ bdrv_write_NEW.c	2021-12-06 23:54:59.569587000 +0800
@@ -6,6 +6,9 @@
         return -ENOMEDIUM;
     if (bs->read_only)
         return -EACCES;
+    if (bdrv_check_request(bs, sector_num, nb_sectors))
+        return -EIO;
+
     if (drv->bdrv_pwrite) {
         int ret, len, count = 0;
         len = nb_sectors * 512;
