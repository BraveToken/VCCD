--- put_page_from_l4e_OLD.c	2021-12-07 00:10:22.648733000 +0800
+++ put_page_from_l4e_NEW.c	2021-12-07 00:10:22.648733000 +0800
@@ -5,7 +5,17 @@
          (l4e_get_pfn(l4e) != pfn) )
     {
         if ( unlikely(partial > 0) )
+        {
+            ASSERT(preemptible >= 0);
             return __put_page_type(l4e_get_page(l4e), preemptible);
+        }
+
+        if ( preemptible < 0 )
+        {
+            current->arch.old_guest_table = l4e_get_page(l4e);
+            return 0;
+        }
+
         return put_page_and_type_preemptible(l4e_get_page(l4e), preemptible);
     }
     return 1;
