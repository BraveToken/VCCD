--- check_get_page_from_gfn_OLD.c	2021-12-07 00:18:13.399661300 +0800
+++ check_get_page_from_gfn_NEW.c	2021-12-07 00:18:13.399661300 +0800
@@ -26,6 +26,15 @@
         return -EAGAIN;
     }
 #endif
+#ifdef CONFIG_X86
+    if ( p2mt == p2m_mmio_direct )
+    {
+        if ( page )
+            put_page(page);
+
+        return -EPERM;
+    }
+#endif
 
     if ( !page )
         return -EINVAL;
