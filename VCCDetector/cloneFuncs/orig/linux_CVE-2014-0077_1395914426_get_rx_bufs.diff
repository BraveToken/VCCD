--- get_rx_bufs_OLD.c	2021-12-06 23:34:35.457560000 +0800
+++ get_rx_bufs_NEW.c	2021-12-06 23:34:35.457560000 +0800
@@ -44,6 +44,12 @@
 	*iovcount = seg;
 	if (unlikely(log))
 		*log_num = nlogs;
+
+	/* Detect overrun */
+	if (unlikely(datalen > 0)) {
+		r = UIO_MAXIOV + 1;
+		goto err;
+	}
 	return headcount;
 err:
 	vhost_discard_vq_desc(vq, headcount);
