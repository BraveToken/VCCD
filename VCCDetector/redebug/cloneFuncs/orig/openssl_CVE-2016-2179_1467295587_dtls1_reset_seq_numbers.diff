--- dtls1_reset_seq_numbers_OLD.c	2021-12-06 23:53:05.369001900 +0800
+++ dtls1_reset_seq_numbers_NEW.c	2021-12-06 23:53:05.369001900 +0800
@@ -9,6 +9,12 @@
         memcpy(&s->rlayer.d->bitmap, &s->rlayer.d->next_bitmap,
                sizeof(s->rlayer.d->bitmap));
         memset(&s->rlayer.d->next_bitmap, 0, sizeof(s->rlayer.d->next_bitmap));
+
+        /*
+         * We must not use any buffered messages received from the previous
+         * epoch
+         */
+        dtls1_clear_received_buffer(s);
     } else {
         seq = s->rlayer.write_sequence;
         memcpy(s->rlayer.d->last_write_sequence, seq,
