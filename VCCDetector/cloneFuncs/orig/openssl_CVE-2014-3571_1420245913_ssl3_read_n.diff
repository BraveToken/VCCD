--- ssl3_read_n_OLD.c	2021-12-06 23:50:56.378997000 +0800
+++ ssl3_read_n_NEW.c	2021-12-06 23:50:56.378997000 +0800
@@ -59,6 +59,8 @@
 	 * at once (as long as it fits into the buffer). */
 	if (SSL_IS_DTLS(s))
 		{
+		if (left == 0 && extend)
+			return 0;
 		if (left > 0 && n > left)
 			n = left;
 		}
