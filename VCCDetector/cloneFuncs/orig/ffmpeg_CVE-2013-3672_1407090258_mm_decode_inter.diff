--- mm_decode_inter_OLD.c	2021-12-06 23:20:16.796151800 +0800
+++ mm_decode_inter_NEW.c	2021-12-06 23:20:16.796151800 +0800
@@ -26,6 +26,8 @@
             int replace_array = bytestream2_get_byte(&s->gb);
             for(j=0; j<8; j++) {
                 int replace = (replace_array >> (7-j)) & 1;
+                if (x + half_horiz >= s->avctx->width)
+                    return AVERROR_INVALIDDATA;
                 if (replace) {
                     int color = bytestream2_get_byte(&data_ptr);
                     s->frame->data[0][y*s->frame->linesize[0] + x] = color;
