--- qcow2_open_OLD.c	2021-12-06 23:56:56.778077100 +0800
+++ qcow2_open_NEW.c	2021-12-06 23:56:56.778077100 +0800
@@ -195,9 +195,7 @@
     }
 
     /* read the level 1 table */
-    if (header.l1_size > 0x2000000) {
-        /* 32 MB L1 table is enough for 2 PB images at 64k cluster size
-         * (128 GB for 512 byte clusters, 2 EB for 2 MB clusters) */
+    if (header.l1_size > QCOW_MAX_L1_SIZE) {
         error_setg(errp, "Active L1 table too large");
         ret = -EFBIG;
         goto fail;
