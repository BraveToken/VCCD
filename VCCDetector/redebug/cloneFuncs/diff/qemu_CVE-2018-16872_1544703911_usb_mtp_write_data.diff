--- usb_mtp_write_data_OLD.c	2021-12-07 00:01:04.088646700 +0800
+++ usb_mtp_write_data_NEW.c	2021-12-07 00:01:04.088646700 +0800
@@ -26,7 +26,7 @@
                                  0, 0, 0, 0);
             goto done;
         }
-        d->fd = open(path, O_CREAT | O_WRONLY, mask);
+        d->fd = open(path, O_CREAT | O_WRONLY | O_CLOEXEC | O_NOFOLLOW, mask);
         if (d->fd == -1) {
             usb_mtp_queue_result(s, RES_STORE_FULL, d->trans,
                                  0, 0, 0, 0);
