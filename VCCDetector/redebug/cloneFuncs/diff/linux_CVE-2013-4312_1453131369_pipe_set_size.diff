--- pipe_set_size_OLD.c	2021-12-06 23:33:48.879140400 +0800
+++ pipe_set_size_NEW.c	2021-12-06 23:33:48.879140400 +0800
@@ -36,6 +36,7 @@
 			memcpy(bufs + head, pipe->bufs, tail * sizeof(struct pipe_buffer));
 	}
 
+	account_pipe_buffers(pipe, pipe->buffers, nr_pages);
 	pipe->curbuf = 0;
 	kfree(pipe->bufs);
 	pipe->bufs = bufs;
