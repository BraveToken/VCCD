--- get_superpage_OLD.c	2021-12-07 00:14:48.779940600 +0800
+++ get_superpage_NEW.c	2021-12-07 00:14:48.779940600 +0800
@@ -6,6 +6,9 @@
 
     ASSERT(opt_allow_superpage);
 
+    if ( !mfn_valid(mfn | (L1_PAGETABLE_ENTRIES - 1)) )
+        return -EINVAL;
+
     spage = mfn_to_spage(mfn);
     y = spage->type_info;
     do {
