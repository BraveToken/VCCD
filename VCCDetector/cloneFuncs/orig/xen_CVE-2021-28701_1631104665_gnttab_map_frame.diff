--- gnttab_map_frame_OLD.c	2021-12-07 00:18:46.937960000 +0800
+++ gnttab_map_frame_NEW.c	2021-12-07 00:18:46.938957100 +0800
@@ -25,7 +25,16 @@
     }
 
     if ( !rc )
-        gnttab_set_frame_gfn(gt, status, idx, gfn);
+    {
+        /*
+         * Make sure gnttab_unpopulate_status_frames() won't (successfully)
+         * free the page until our caller has completed its operation.
+         */
+        if ( get_page(mfn_to_page(*mfn), d) )
+            gnttab_set_frame_gfn(gt, status, idx, gfn);
+        else
+            rc = -EBUSY;
+    }
 
     grant_write_unlock(gt);
 
