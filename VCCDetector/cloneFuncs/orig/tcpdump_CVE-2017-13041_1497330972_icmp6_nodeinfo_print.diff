--- icmp6_nodeinfo_print_OLD.c	2021-12-07 00:06:51.768720600 +0800
+++ icmp6_nodeinfo_print_NEW.c	2021-12-07 00:06:51.769717900 +0800
@@ -134,6 +134,7 @@
 
 		needcomma = 0;
 
+		ND_TCHECK2(*dp, sizeof(*ni6));
 		ni6 = (const struct icmp6_nodeinfo *)dp;
 		ND_PRINT((ndo," node information reply"));
 		ND_PRINT((ndo," ("));	/*)*/
@@ -188,6 +189,7 @@
 				ND_PRINT((ndo,", "));
 			ND_PRINT((ndo,"DNS name"));
 			cp = (const u_char *)(ni6 + 1) + 4;
+			ND_TCHECK(cp[0]);
 			if (cp[0] == ep - cp - 1) {
 				/* icmp-name-lookup-03, pascal string */
 				if (ndo->ndo_vflag)
