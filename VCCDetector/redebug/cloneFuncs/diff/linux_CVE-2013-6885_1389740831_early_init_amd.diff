--- early_init_amd_OLD.c	2021-12-06 23:34:17.472663600 +0800
+++ early_init_amd_NEW.c	2021-12-06 23:34:17.472663600 +0800
@@ -31,4 +31,14 @@
 			set_cpu_cap(c, X86_FEATURE_EXTD_APICID);
 	}
 #endif
+
+	/* F16h erratum 793, CVE-2013-6885 */
+	if (c->x86 == 0x16 && c->x86_model <= 0xf) {
+		u64 val;
+
+		rdmsrl(MSR_AMD64_LS_CFG, val);
+		if (!(val & BIT(15)))
+			wrmsrl(MSR_AMD64_LS_CFG, val | BIT(15));
+	}
+
 }
