--- clnp_print_OLD.c	2021-12-07 00:07:51.295539400 +0800
+++ clnp_print_NEW.c	2021-12-07 00:07:51.295539400 +0800
@@ -33,11 +33,13 @@
 
         pptr += sizeof(struct clnp_header_t);
         li -= sizeof(struct clnp_header_t);
+	ND_TCHECK(*pptr);
         dest_address_length = *pptr;
         dest_address = pptr + 1;
 
         pptr += (1 + dest_address_length);
         li -= (1 + dest_address_length);
+	ND_TCHECK(*pptr);
         source_address_length = *pptr;
         source_address = pptr +1;
 
