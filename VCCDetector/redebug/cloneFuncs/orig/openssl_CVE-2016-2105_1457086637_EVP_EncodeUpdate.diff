--- EVP_EncodeUpdate_OLD.c	2021-12-06 23:52:34.984268600 +0800
+++ EVP_EncodeUpdate_NEW.c	2021-12-06 23:52:34.984268600 +0800
@@ -8,7 +8,7 @@
     if (inl <= 0)
         return;
     OPENSSL_assert(ctx->length <= (int)sizeof(ctx->enc_data));
-    if ((ctx->num + inl) < ctx->length) {
+    if (ctx->length - ctx->num > inl) {
         memcpy(&(ctx->enc_data[ctx->num]), in, inl);
         ctx->num += inl;
         return;
