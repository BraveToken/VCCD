--- dtls1_reassemble_fragment_OLD.c	2021-12-06 23:49:50.089323100 +0800
+++ dtls1_reassemble_fragment_NEW.c	2021-12-06 23:49:50.089323100 +0800
@@ -37,7 +37,16 @@
 		frag->msg_header.frag_off = 0;
 		}
 	else
+		{
 		frag = (hm_fragment*) item->data;
+		if (frag->msg_header.msg_len != msg_hdr->msg_len)
+			{
+			item = NULL;
+			frag = NULL;
+			goto err;
+			}
+		}
+
 
 	/* If message is already reassembled, this must be a
 	 * retransmit and can be dropped.
