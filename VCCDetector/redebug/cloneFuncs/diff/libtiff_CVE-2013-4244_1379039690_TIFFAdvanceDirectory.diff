--- TIFFAdvanceDirectory_OLD.c	2021-12-06 23:25:49.229006400 +0800
+++ TIFFAdvanceDirectory_NEW.c	2021-12-06 23:25:49.229006400 +0800
@@ -15,6 +15,7 @@
 			if (((uint64)poffa!=poff)||(poffb<poffa)||(poffb<(tmsize_t)sizeof(uint16))||(poffb>tif->tif_size))
 			{
 				TIFFErrorExt(tif->tif_clientdata,module,"Error fetching directory count");
+                                  *nextdir=0;
 				return(0);
 			}
 			_TIFFmemcpy(&dircount,tif->tif_base+poffa,sizeof(uint16));
