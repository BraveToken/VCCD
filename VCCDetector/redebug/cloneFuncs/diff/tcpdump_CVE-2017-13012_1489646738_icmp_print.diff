--- icmp_print_OLD.c	2021-12-07 00:05:25.028714800 +0800
+++ icmp_print_NEW.c	2021-12-07 00:05:25.028714800 +0800
@@ -253,6 +253,7 @@
 		ND_PRINT((ndo, "\n\t"));
 		ip = (const struct ip *)bp;
                 snapend_save = ndo->ndo_snapend;
+		ND_TCHECK_16BITS(&ip->ip_len);
 		ip_print(ndo, bp, EXTRACT_16BITS(&ip->ip_len));
                 ndo->ndo_snapend = snapend_save;
 	}
