--- perf_trace_event_perm_OLD.c	2021-12-06 23:33:41.909778900 +0800
+++ perf_trace_event_perm_NEW.c	2021-12-06 23:33:41.910776200 +0800
@@ -3,7 +3,7 @@
 {
 	/* The ftrace function trace is allowed only for root. */
 	if (ftrace_event_is_function(tp_event) &&
-	    perf_paranoid_kernel() && !capable(CAP_SYS_ADMIN))
+	    perf_paranoid_tracepoint_raw() && !capable(CAP_SYS_ADMIN))
 		return -EPERM;
 
 	/* No tracing, just counting, so no obvious leak */
