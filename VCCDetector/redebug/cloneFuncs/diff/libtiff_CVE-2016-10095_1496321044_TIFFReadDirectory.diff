--- TIFFReadDirectory_OLD.c	2021-12-06 23:26:10.828237600 +0800
+++ TIFFReadDirectory_NEW.c	2021-12-06 23:26:10.828237600 +0800
@@ -169,6 +169,10 @@
 							goto bad;
 						dp->tdir_tag=IGNORE;
 						break;
+                                        default:
+                                            if( !_TIFFCheckFieldIsValidForCodec(tif, dp->tdir_tag) )
+                                                dp->tdir_tag=IGNORE;
+                                            break;
 				}
 			}
 		}
