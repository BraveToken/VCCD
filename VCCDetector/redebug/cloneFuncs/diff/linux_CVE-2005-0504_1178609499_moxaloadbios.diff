--- moxaloadbios_OLD.c	2021-12-06 23:27:47.545557600 +0800
+++ moxaloadbios_NEW.c	2021-12-06 23:27:47.545557600 +0800
@@ -3,6 +3,8 @@
 	void __iomem *baseAddr;
 	int i;
 
+	if(len < 0 || len > sizeof(moxaBuff))
+		return -EINVAL;
 	if(copy_from_user(moxaBuff, tmp, len))
 		return -EFAULT;
 	baseAddr = moxa_boards[cardno].basemem;
