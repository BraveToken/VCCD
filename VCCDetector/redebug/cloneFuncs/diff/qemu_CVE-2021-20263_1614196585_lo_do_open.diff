--- lo_do_open_OLD.c	2021-12-07 00:02:16.416205300 +0800
+++ lo_do_open_NEW.c	2021-12-07 00:02:16.417202000 +0800
@@ -27,6 +27,13 @@
         if (fd < 0) {
             return -fd;
         }
+        if (fi->flags & (O_TRUNC)) {
+            int err = drop_security_capability(lo, fd);
+            if (err) {
+                close(fd);
+                return err;
+            }
+        }
     }
 
     pthread_mutex_lock(&lo->mutex);
