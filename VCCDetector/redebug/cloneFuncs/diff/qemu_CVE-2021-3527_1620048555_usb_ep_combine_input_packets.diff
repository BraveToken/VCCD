--- usb_ep_combine_input_packets_OLD.c	2021-12-07 00:02:23.920106200 +0800
+++ usb_ep_combine_input_packets_NEW.c	2021-12-07 00:02:23.921103400 +0800
@@ -50,7 +50,9 @@
         if ((p->iov.size % ep->max_packet_size) != 0 || !p->short_not_ok ||
                 next == NULL ||
                 /* Work around for Linux usbfs bulk splitting + migration */
-                (totalsize == (16 * KiB - 36) && p->int_req)) {
+                (totalsize == (16 * KiB - 36) && p->int_req) ||
+                /* Next package may grow combined package over 1MiB */
+                totalsize > 1 * MiB - ep->max_packet_size) {
             usb_device_handle_data(ep->dev, first);
             assert(first->status == USB_RET_ASYNC);
             if (first->combined) {
