--- ws_snd_decode_frame_OLD.c	2021-12-06 23:18:26.307664300 +0800
+++ ws_snd_decode_frame_NEW.c	2021-12-06 23:18:26.307664300 +0800
@@ -52,8 +52,8 @@
 
         /* make sure we don't write past the output buffer */
         switch (code) {
-        case 0:  smp = 4;                              break;
-        case 1:  smp = 2;                              break;
+        case 0:  smp = 4 * (count + 1);                break;
+        case 1:  smp = 2 * (count + 1);                break;
         case 2:  smp = (count & 0x20) ? 1 : count + 1; break;
         default: smp = count + 1;                      break;
         }
