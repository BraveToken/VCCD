--- gdth_read_event_OLD.c	2021-12-06 23:29:37.498480300 +0800
+++ gdth_read_event_NEW.c	2021-12-06 23:29:37.498480300 +0800
@@ -12,7 +12,7 @@
         eindex = handle;
     estr->event_source = 0;
 
-    if (eindex >= MAX_EVENTS) {
+    if (eindex < 0 || eindex >= MAX_EVENTS) {
         spin_unlock_irqrestore(&ha->smp_lock, flags);
         return eindex;
     }
