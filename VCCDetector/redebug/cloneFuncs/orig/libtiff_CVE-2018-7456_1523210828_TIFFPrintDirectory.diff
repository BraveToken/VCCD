--- TIFFPrintDirectory_OLD.c	2021-12-06 23:27:26.370193300 +0800
+++ TIFFPrintDirectory_NEW.c	2021-12-06 23:27:26.371190900 +0800
@@ -312,7 +312,7 @@
 				uint16 i;
 				fprintf(fd, "    %2ld: %5u",
 				    l, td->td_transferfunction[0][l]);
-				for (i = 1; i < td->td_samplesperpixel; i++)
+				for (i = 1; i < td->td_samplesperpixel - td->td_extrasamples && i < 3; i++)
 					fprintf(fd, " %5u",
 					    td->td_transferfunction[i][l]);
 				fputc('\n', fd);
