--- tls1_check_sig_alg_OLD.c	2021-12-06 23:54:25.351082200 +0800
+++ tls1_check_sig_alg_NEW.c	2021-12-06 23:54:25.351082200 +0800
@@ -25,7 +25,7 @@
         sigalg = use_pc_sigalgs
                  ? tls1_lookup_sigalg(s->s3.tmp.peer_cert_sigalgs[i])
                  : s->shared_sigalgs[i];
-        if (sig_nid == sigalg->sigandhash)
+        if (sigalg != NULL && sig_nid == sigalg->sigandhash)
             return 1;
     }
     return 0;
