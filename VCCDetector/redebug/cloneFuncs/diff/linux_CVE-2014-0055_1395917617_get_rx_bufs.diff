--- get_rx_bufs_OLD.c	2021-12-06 23:34:28.432350000 +0800
+++ get_rx_bufs_NEW.c	2021-12-06 23:34:28.432350000 +0800
@@ -17,9 +17,13 @@
 			r = -ENOBUFS;
 			goto err;
 		}
-		d = vhost_get_vq_desc(vq->dev, vq, vq->iov + seg,
+		r = vhost_get_vq_desc(vq->dev, vq, vq->iov + seg,
 				      ARRAY_SIZE(vq->iov) - seg, &out,
 				      &in, log, log_num);
+		if (unlikely(r < 0))
+			goto err;
+
+		d = r;
 		if (d == vq->num) {
 			r = 0;
 			goto err;
