--- chacha20_poly1305_cipher_OLD.c	2021-12-06 23:53:46.852079800 +0800
+++ chacha20_poly1305_cipher_NEW.c	2021-12-06 23:53:46.852079800 +0800
@@ -104,7 +104,7 @@
                 memcpy(out, actx->tag, POLY1305_BLOCK_SIZE);
             } else {
                 if (CRYPTO_memcmp(temp, in, POLY1305_BLOCK_SIZE)) {
-                    memset(out, 0, plen);
+                    memset(out - plen, 0, plen);
                     return -1;
                 }
             }
