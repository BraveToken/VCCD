--- smka_decode_frame_OLD.c	2021-12-06 23:24:52.176598000 +0800
+++ smka_decode_frame_NEW.c	2021-12-06 23:24:52.176598000 +0800
@@ -39,6 +39,11 @@
         av_log(avctx, AV_LOG_ERROR, "sample format mismatch\n");
         return AVERROR(EINVAL);
     }
+    if (unp_size % (avctx->channels * (bits + 1))) {
+        av_log(avctx, AV_LOG_ERROR,
+               "The buffer does not contain an integer number of samples\n");
+        return AVERROR(EINVAL);
+    }
 
     /* get output buffer */
     frame->nb_samples = unp_size / (avctx->channels * (bits + 1));
