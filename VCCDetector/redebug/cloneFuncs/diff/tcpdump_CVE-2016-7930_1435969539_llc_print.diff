--- llc_print_OLD.c	2021-12-07 00:03:09.370545000 +0800
+++ llc_print_NEW.c	2021-12-07 00:03:09.370545000 +0800
@@ -210,6 +210,12 @@
                        length + hdrlen));
 
 		if ((control & ~LLC_U_POLL) == LLC_XID) {
+			if (caplen < 2 || length < 2) {
+				ND_PRINT((ndo, "[|llc]"));
+				if (caplen > 0)
+					ND_DEFAULTPRINT((const u_char *)p, caplen);
+				return (hdrlen);
+			}
 			if (*p == LLC_XID_FI) {
 				ND_PRINT((ndo, ": %02x %02x", p[1], p[2]));
 				return (hdrlen);
