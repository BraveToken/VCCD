--- IPAddressOrRanges_canonize_OLD.c	2021-12-06 23:48:49.250046000 +0800
+++ IPAddressOrRanges_canonize_NEW.c	2021-12-06 23:48:49.250046000 +0800
@@ -17,8 +17,9 @@
     unsigned char a_min[ADDR_RAW_BUF_LEN], a_max[ADDR_RAW_BUF_LEN];
     unsigned char b_min[ADDR_RAW_BUF_LEN], b_max[ADDR_RAW_BUF_LEN];
 
-    extract_min_max(a, a_min, a_max, length);
-    extract_min_max(b, b_min, b_max, length);
+    if (!extract_min_max(a, a_min, a_max, length) ||
+	!extract_min_max(b, b_min, b_max, length))
+      return 0;
 
     /*
      * Punt inverted ranges.
