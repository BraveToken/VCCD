--- do_key_event_OLD.c	2021-12-07 00:08:30.495666400 +0800
+++ do_key_event_NEW.c	2021-12-07 00:08:30.495666400 +0800
@@ -32,6 +32,7 @@
 	    kbd_put_keycode(keycode & 0x7f);
 	else
 	    kbd_put_keycode(keycode | 0x80);
+#ifdef QEMU_VNC_MONITOR_EXPORT
     } else if (down) {
 	int qemu_keysym = 0;
 
@@ -59,8 +60,10 @@
 	}
 	if (qemu_keysym != 0)
 	    kbd_put_keysym(qemu_keysym);
+#endif
     }
 
+#ifdef QEMU_VNC_MONITOR_EXPORT
     if (down) {
 	switch (sym) {
 	case XK_Control_L:
@@ -113,4 +116,8 @@
 	    break;
 	}
     }
+#else
+    if (!down && sym == XK_Num_Lock)
+        vs->numlock = !vs->numlock;
+#endif
 }
