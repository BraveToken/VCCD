--- tls1_enc_OLD.c	2021-12-06 23:49:15.884777900 +0800
+++ tls1_enc_NEW.c	2021-12-06 23:49:15.884777900 +0800
@@ -220,6 +220,8 @@
 			if (s->version >= TLS1_1_VERSION
 				&& EVP_CIPHER_CTX_mode(ds) == EVP_CIPH_CBC_MODE)
 				{
+				if (bs > (int)rec->length)
+					return -1;
 				rec->data += bs;    /* skip the explicit IV */
 				rec->input += bs;
 				rec->length -= bs;
