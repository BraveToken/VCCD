--- hid_parser_global_OLD.c	2021-12-06 23:32:54.664141300 +0800
+++ hid_parser_global_NEW.c	2021-12-06 23:32:54.664141300 +0800
@@ -85,8 +85,10 @@
 
 	case HID_GLOBAL_ITEM_TAG_REPORT_ID:
 		parser->global.report_id = item_udata(item);
-		if (parser->global.report_id == 0) {
-			hid_err(parser->device, "report_id 0 is invalid\n");
+		if (parser->global.report_id == 0 ||
+		    parser->global.report_id >= HID_MAX_IDS) {
+			hid_err(parser->device, "report_id %u is invalid\n",
+				parser->global.report_id);
 			return -1;
 		}
 		return 0;
