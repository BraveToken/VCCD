int
ah_print(netdissect_options *ndo, register const u_char *bp)
{
	register const struct ah *ah;
	int sumlen;

	ah = (const struct ah *)bp;

	ND_TCHECK(*ah);

	sumlen = ah->ah_len << 2;

	ND_PRINT((ndo, "AH(spi=0x%08x", EXTRACT_32BITS(&ah->ah_spi)));
	if (ndo->ndo_vflag)
		ND_PRINT((ndo, ",sumlen=%d", sumlen));
	ND_TCHECK_32BITS(ah + 1);
	ND_PRINT((ndo, ",seq=0x%x", EXTRACT_32BITS(ah + 1)));
	if (!ND_TTEST2(*bp, sizeof(struct ah) + sumlen)) {
		ND_PRINT((ndo, "[truncated]):"));
		return -1;
	}
	ND_PRINT((ndo, "): "));

	return sizeof(struct ah) + sumlen;
 trunc:
	ND_PRINT((ndo, "[|AH]"));
	return -1;
}
