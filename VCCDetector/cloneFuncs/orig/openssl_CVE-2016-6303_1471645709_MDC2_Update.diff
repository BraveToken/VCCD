--- MDC2_Update_OLD.c	2021-12-06 23:53:26.004809400 +0800
+++ MDC2_Update_NEW.c	2021-12-06 23:53:26.005806600 +0800
@@ -4,7 +4,7 @@
 
     i = c->num;
     if (i != 0) {
-        if (i + len < MDC2_BLOCK) {
+        if (len < MDC2_BLOCK - i) {
             /* partial block */
             memcpy(&(c->data[i]), in, len);
             c->num += (int)len;
