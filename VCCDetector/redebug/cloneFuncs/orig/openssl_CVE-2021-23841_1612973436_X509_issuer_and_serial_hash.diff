--- X509_issuer_and_serial_hash_OLD.c	2021-12-06 23:54:33.979033500 +0800
+++ X509_issuer_and_serial_hash_NEW.c	2021-12-06 23:54:33.979033500 +0800
@@ -8,6 +8,8 @@
     if (ctx == NULL)
         goto err;
     f = X509_NAME_oneline(a->cert_info.issuer, NULL, 0);
+    if (f == NULL)
+        goto err;
     if (!EVP_DigestInit_ex(ctx, EVP_md5(), NULL))
         goto err;
     if (!EVP_DigestUpdate(ctx, (unsigned char *)f, strlen(f)))
