--- mp_capable_print_OLD.c	2021-12-07 00:06:48.189314200 +0800
+++ mp_capable_print_NEW.c	2021-12-07 00:06:48.189314200 +0800
@@ -4,7 +4,7 @@
 {
         const struct mp_capable *mpc = (const struct mp_capable *) opt;
 
-        if (!(opt_len == 12 && flags & TH_SYN) &&
+        if (!(opt_len == 12 && (flags & TH_SYN)) &&
             !(opt_len == 20 && (flags & (TH_SYN | TH_ACK)) == TH_ACK))
                 return 0;
 
