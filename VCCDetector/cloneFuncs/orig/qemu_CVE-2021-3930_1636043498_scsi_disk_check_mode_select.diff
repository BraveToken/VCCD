--- scsi_disk_check_mode_select_OLD.c	2021-12-07 00:02:39.883435200 +0800
+++ scsi_disk_check_mode_select_NEW.c	2021-12-07 00:02:39.883435200 +0800
@@ -14,6 +14,11 @@
         return -1;
     }
 
+    /* MODE_PAGE_ALLS is only valid for MODE SENSE commands */
+    if (page == MODE_PAGE_ALLS) {
+        return -1;
+    }
+
     p = mode_current;
     memset(mode_current, 0, inlen + 2);
     len = mode_sense_page(s, page, &p, 0);
