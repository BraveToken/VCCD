--- lz4_uncompress_unknownoutputsize_OLD.c	2021-12-07 00:12:15.230593600 +0800
+++ lz4_uncompress_unknownoutputsize_NEW.c	2021-12-07 00:12:15.231619000 +0800
@@ -50,6 +50,8 @@
 			op += length;
 			break;/* Necessarily EOF, due to parsing restrictions */
 		}
+		if (unlikely((unsigned long)cpy < (unsigned long)op))
+			goto _output_error;
 		LZ4_WILDCOPY(ip, op, cpy);
 		ip -= (op - cpy);
 		op = cpy;
@@ -113,6 +115,8 @@
 				goto _output_error;
 			continue;
 		}
+		if (unlikely((unsigned long)cpy < (unsigned long)op))
+			goto _output_error;
 		LZ4_SECURECOPY(ref, op, cpy);
 		op = cpy; /* correction */
 	}
