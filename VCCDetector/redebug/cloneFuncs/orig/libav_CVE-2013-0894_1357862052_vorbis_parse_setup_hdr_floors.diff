--- vorbis_parse_setup_hdr_floors_OLD.c	2021-12-06 23:24:00.206596900 +0800
+++ vorbis_parse_setup_hdr_floors_NEW.c	2021-12-06 23:24:00.206596900 +0800
@@ -105,6 +105,11 @@
             floor_setup->data.t0.order          = get_bits(gb,  8);
             floor_setup->data.t0.rate           = get_bits(gb, 16);
             floor_setup->data.t0.bark_map_size  = get_bits(gb, 16);
+            if (floor_setup->data.t0.bark_map_size == 0) {
+                av_log(vc->avccontext, AV_LOG_ERROR,
+                       "Floor 0 bark map size is 0.\n");
+                return AVERROR_INVALIDDATA;
+            }
             floor_setup->data.t0.amplitude_bits = get_bits(gb,  6);
             /* zero would result in a div by zero later *
              * 2^0 - 1 == 0                             */
