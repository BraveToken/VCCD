--- EVP_EncryptUpdate_OLD.c	2021-12-06 23:52:38.307404200 +0800
+++ EVP_EncryptUpdate_NEW.c	2021-12-06 23:52:38.307404200 +0800
@@ -30,7 +30,7 @@
     bl = ctx->cipher->block_size;
     OPENSSL_assert(bl <= (int)sizeof(ctx->buf));
     if (i != 0) {
-        if (i + inl < bl) {
+        if (bl - i > inl) {
             memcpy(&(ctx->buf[i]), in, inl);
             ctx->buf_len += inl;
             *outl = 0;
