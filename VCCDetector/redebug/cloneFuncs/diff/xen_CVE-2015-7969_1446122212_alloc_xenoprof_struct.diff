--- alloc_xenoprof_struct_OLD.c	2021-12-07 00:14:17.456687700 +0800
+++ alloc_xenoprof_struct_NEW.c	2021-12-07 00:14:17.456687700 +0800
@@ -52,6 +52,7 @@
     d->xenoprof->rawbuf = alloc_xenheap_pages(get_order_from_pages(npages), 0);
     if ( d->xenoprof->rawbuf == NULL )
     {
+        xfree(d->xenoprof->vcpu);
         xfree(d->xenoprof);
         d->xenoprof = NULL;
         return -ENOMEM;
