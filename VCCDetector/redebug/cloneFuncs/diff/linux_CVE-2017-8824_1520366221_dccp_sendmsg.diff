--- dccp_sendmsg_OLD.c	2021-12-06 23:40:42.016166100 +0800
+++ dccp_sendmsg_NEW.c	2021-12-06 23:40:42.016166100 +0800
@@ -37,6 +37,11 @@
 	if (skb == NULL)
 		goto out_release;
 
+	if (sk->sk_state == DCCP_CLOSED) {
+		rc = -ENOTCONN;
+		goto out_discard;
+	}
+
 	skb_reserve(skb, sk->sk_prot->max_header);
 	rc = memcpy_from_msg(skb_put(skb, len), msg, len);
 	if (rc != 0)
