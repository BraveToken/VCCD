--- BN_hex2bn_OLD.c	2021-12-06 23:52:20.866057300 +0800
+++ BN_hex2bn_NEW.c	2021-12-06 23:52:20.866057300 +0800
@@ -13,7 +13,11 @@
         a++;
     }
 
-    for (i = 0; isxdigit((unsigned char)a[i]); i++) ;
+    for (i = 0; i <= (INT_MAX/4) && isxdigit((unsigned char)a[i]); i++)
+        continue;
+
+    if (i > INT_MAX/4)
+        goto err;
 
     num = i + neg;
     if (bn == NULL)
@@ -28,7 +32,7 @@
         BN_zero(ret);
     }
 
-    /* i is the number of hex digests; */
+    /* i is the number of hex digits */
     if (bn_expand(ret, i * 4) == NULL)
         goto err;
 
