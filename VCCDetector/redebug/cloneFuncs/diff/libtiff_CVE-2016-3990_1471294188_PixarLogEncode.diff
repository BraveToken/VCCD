--- PixarLogEncode_OLD.c	2021-12-06 23:26:28.124977200 +0800
+++ PixarLogEncode_NEW.c	2021-12-06 23:26:28.124977200 +0800
@@ -32,6 +32,13 @@
 	}
 
 	llen = sp->stride * td->td_imagewidth;
+    /* Check against the number of elements (of size uint16) of sp->tbuf */
+    if( n > td->td_rowsperstrip * llen )
+    {
+        TIFFErrorExt(tif->tif_clientdata, module,
+                     "Too many input bytes provided");
+        return 0;
+    }
 
 	for (i = 0, up = sp->tbuf; i < n; i += llen, up += llen) {
 		switch (sp->user_datafmt)  {
