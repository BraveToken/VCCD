--- lz4_uncompress_OLD.c	2021-12-07 00:12:15.180754300 +0800
+++ lz4_uncompress_NEW.c	2021-12-07 00:12:15.180754300 +0800
@@ -41,6 +41,8 @@
 			ip += length;
 			break; /* EOF */
 		}
+		if (unlikely((unsigned long)cpy < (unsigned long)op))
+			goto _output_error;
 		LZ4_WILDCOPY(ip, op, cpy);
 		ip -= (op - cpy);
 		op = cpy;
@@ -99,6 +101,8 @@
 				goto _output_error;
 			continue;
 		}
+		if (unlikely((unsigned long)cpy < (unsigned long)op))
+			goto _output_error;
 		LZ4_SECURECOPY(ref, op, cpy);
 		op = cpy; /* correction */
 	}
