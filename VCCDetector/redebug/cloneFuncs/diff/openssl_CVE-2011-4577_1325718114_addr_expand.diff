--- addr_expand_OLD.c	2021-12-06 23:48:48.989735200 +0800
+++ addr_expand_NEW.c	2021-12-06 23:48:48.989735200 +0800
@@ -1,9 +1,10 @@
-static void addr_expand(unsigned char *addr,
+static int addr_expand(unsigned char *addr,
 			const ASN1_BIT_STRING *bs,
 			const int length,
 			const unsigned char fill)
 {
-  OPENSSL_assert(bs->length >= 0 && bs->length <= length);
+  if (bs->length < 0 || bs->length > length)
+    return 0;
   if (bs->length > 0) {
     memcpy(addr, bs->data, bs->length);
     if ((bs->flags & 7) != 0) {
@@ -15,4 +16,5 @@
     }
   }
   memset(addr + bs->length, fill, length - bs->length);
+  return 1;
 }
