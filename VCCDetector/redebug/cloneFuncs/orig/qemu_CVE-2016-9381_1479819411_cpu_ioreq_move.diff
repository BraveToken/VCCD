--- cpu_ioreq_move_OLD.c	2021-12-06 23:59:29.665192100 +0800
+++ cpu_ioreq_move_NEW.c	2021-12-06 23:59:29.666188500 +0800
@@ -5,6 +5,10 @@
     trace_cpu_ioreq_move(req, req->dir, req->df, req->data_is_ptr, req->addr,
                          req->data, req->count, req->size);
 
+    if (req->size > sizeof(req->data)) {
+        hw_error("MMIO: bad size (%u)", req->size);
+    }
+
     if (!req->data_is_ptr) {
         if (req->dir == IOREQ_READ) {
             for (i = 0; i < req->count; i++) {
