--- emulate_privileged_op_OLD.c	2021-12-07 00:10:43.706382400 +0800
+++ emulate_privileged_op_NEW.c	2021-12-07 00:10:43.706382400 +0800
@@ -362,6 +362,11 @@
                     if ( !(new_xfeature & XSTATE_FP) || (new_xfeature & ~xfeature_mask) )
                         goto fail;
 
+                    /* YMM state takes SSE state as prerequisite. */
+                    if ( (xfeature_mask & new_xfeature & XSTATE_YMM) &&
+                         !(new_xfeature & XSTATE_SSE) )
+                        goto fail;
+
                     v->arch.xcr0 = new_xfeature;
                     v->arch.xcr0_accum |= new_xfeature;
                     set_xcr0(new_xfeature);
