--- sys_oabi_semtimedop_OLD.c	2021-12-06 23:37:26.578882000 +0800
+++ sys_oabi_semtimedop_NEW.c	2021-12-06 23:37:26.578882000 +0800
@@ -10,6 +10,8 @@
 
 	if (nsops < 1 || nsops > SEMOPM)
 		return -EINVAL;
+	if (!access_ok(VERIFY_READ, tsops, sizeof(*tsops) * nsops))
+		return -EFAULT;
 	sops = kmalloc(sizeof(*sops) * nsops, GFP_KERNEL);
 	if (!sops)
 		return -ENOMEM;
