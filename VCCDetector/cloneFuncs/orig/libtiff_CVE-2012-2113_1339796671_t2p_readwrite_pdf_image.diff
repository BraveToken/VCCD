--- t2p_readwrite_pdf_image_OLD.c	2021-12-06 23:25:35.311230800 +0800
+++ t2p_readwrite_pdf_image_NEW.c	2021-12-06 23:25:35.311230800 +0800
@@ -28,6 +28,10 @@
 	uint32 max_striplength=0;
 #endif
 
+	/* Fail if prior error (in particular, can't trust tiff_datasize) */
+	if (t2p->t2p_error != T2P_ERR_OK)
+		return(0);
+
 	if(t2p->pdf_transcode == T2P_TRANSCODE_RAW){
 #ifdef CCITT_SUPPORT
 		if(t2p->pdf_compression == T2P_COMPRESS_G4){
