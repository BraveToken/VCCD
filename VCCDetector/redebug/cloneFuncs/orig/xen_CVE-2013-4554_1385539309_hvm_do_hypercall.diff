--- hvm_do_hypercall_OLD.c	2021-12-07 00:11:41.047019700 +0800
+++ hvm_do_hypercall_NEW.c	2021-12-07 00:11:41.048017000 +0800
@@ -11,7 +11,7 @@
     case 4:
     case 2:
         hvm_get_segment_register(curr, x86_seg_ss, &sreg);
-        if ( unlikely(sreg.attr.fields.dpl == 3) )
+        if ( unlikely(sreg.attr.fields.dpl) )
         {
     default:
             regs->eax = -EPERM;
