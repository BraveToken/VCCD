--- hso_get_config_data_OLD.c	2021-12-06 23:43:01.871140700 +0800
+++ hso_get_config_data_NEW.c	2021-12-06 23:43:01.871140700 +0800
@@ -14,6 +14,12 @@
 		return -EIO;
 	}
 
+	/* check if we have a valid interface */
+	if (if_num > 16) {
+		kfree(config_data);
+		return -EINVAL;
+	}
+
 	switch (config_data[if_num]) {
 	case 0x0:
 		result = 0;
