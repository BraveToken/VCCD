--- ide_data_readw_OLD.c	2021-12-06 23:58:18.140511000 +0800
+++ ide_data_readw_NEW.c	2021-12-06 23:58:18.141509700 +0800
@@ -12,6 +12,10 @@
     }
 
     p = s->data_ptr;
+    if (p + 2 > s->data_end) {
+        return 0;
+    }
+
     ret = cpu_to_le16(*(uint16_t *)p);
     p += 2;
     s->data_ptr = p;
