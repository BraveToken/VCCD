--- blit_region_is_unsafe_OLD.c	2021-12-07 00:00:26.135154700 +0800
+++ blit_region_is_unsafe_NEW.c	2021-12-07 00:00:26.135154700 +0800
@@ -3,10 +3,9 @@
 {
     if (pitch < 0) {
         int64_t min = addr
-            + ((int64_t)s->cirrus_blt_height-1) * pitch;
-        int32_t max = addr
-            + s->cirrus_blt_width;
-        if (min < 0 || max > s->vga.vram_size) {
+            + ((int64_t)s->cirrus_blt_height - 1) * pitch
+            - s->cirrus_blt_width;
+        if (min < -1 || addr >= s->vga.vram_size) {
             return true;
         }
     } else {
