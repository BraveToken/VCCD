--- ip_optprint_OLD.c	2021-12-07 00:05:52.332707600 +0800
+++ ip_optprint_NEW.c	2021-12-07 00:05:52.333704800 +0800
@@ -48,7 +48,8 @@
 		case IPOPT_RR:       /* fall through */
 		case IPOPT_SSRR:
 		case IPOPT_LSRR:
-			ip_printroute(ndo, cp, option_len);
+			if (ip_printroute(ndo, cp, option_len) == -1)
+				goto trunc;
 			break;
 
 		case IPOPT_RA:
