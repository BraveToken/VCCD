--- nvmx_handle_vmresume_OLD.c	2021-12-07 00:11:33.741588200 +0800
+++ nvmx_handle_vmresume_NEW.c	2021-12-07 00:11:33.741588200 +0800
@@ -4,6 +4,10 @@
     struct vcpu *v = current;
     struct nestedvcpu *nvcpu = &vcpu_nestedhvm(v);
     struct nestedvmx *nvmx = &vcpu_2_nvmx(v);
+    int rc = vmx_inst_check_privilege(regs, 0);
+
+    if ( rc != X86EMUL_OKAY )
+        return rc;
 
     if ( vcpu_nestedhvm(v).nv_vvmcxaddr == VMCX_EADDR )
     {
