--- decnet_print_OLD.c	2021-12-07 00:04:12.133679400 +0800
+++ decnet_print_NEW.c	2021-12-07 00:04:12.134676900 +0800
@@ -44,6 +44,7 @@
 	    length -= padlen;
 	    caplen -= padlen;
 	    rhp = (const union routehdr *)&(ap[sizeof(short)]);
+	    ND_TCHECK(rhp->rh_short.sh_flags);
 	    mflags = EXTRACT_LE_8BITS(rhp->rh_short.sh_flags);
 	}
 
