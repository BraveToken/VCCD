--- check_nnp_nosuid_OLD.c	2021-12-06 23:35:40.591356200 +0800
+++ check_nnp_nosuid_NEW.c	2021-12-06 23:35:40.591356200 +0800
@@ -3,7 +3,7 @@
 			    const struct task_security_struct *new_tsec)
 {
 	int nnp = (bprm->unsafe & LSM_UNSAFE_NO_NEW_PRIVS);
-	int nosuid = (bprm->file->f_path.mnt->mnt_flags & MNT_NOSUID);
+	int nosuid = !mnt_may_suid(bprm->file->f_path.mnt);
 	int rc;
 
 	if (!nnp && !nosuid)
