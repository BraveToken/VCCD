--- mwifiex_set_wmm_params_OLD.c	2021-12-06 23:43:54.967122500 +0800
+++ mwifiex_set_wmm_params_NEW.c	2021-12-06 23:43:54.967122500 +0800
@@ -13,6 +13,8 @@
 					    params->beacon.tail_len);
 	if (vendor_ie) {
 		wmm_ie = vendor_ie;
+		if (*(wmm_ie + 1) > sizeof(struct mwifiex_types_wmm_info))
+			return;
 		memcpy(&bss_cfg->wmm_info, wmm_ie +
 		       sizeof(struct ieee_types_header), *(wmm_ie + 1));
 		priv->wmm_enabled = 1;
