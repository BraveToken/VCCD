--- gnttab_unpopulate_status_frames_OLD.c	2021-12-07 00:09:30.173088500 +0800
+++ gnttab_unpopulate_status_frames_NEW.c	2021-12-07 00:09:30.173088500 +0800
@@ -5,7 +5,12 @@
 
     for ( i = 0; i < nr_status_frames(gt); i++ )
     {
-        page_set_owner(virt_to_page(gt->status[i]), dom_xen);
+        struct page_info *pg = virt_to_page(gt->status[i]);
+
+        BUG_ON(page_get_owner(pg) != d);
+        if ( test_and_clear_bit(_PGC_allocated, &pg->count_info) )
+            put_page(pg);
+        BUG_ON(pg->count_info & ~PGC_xen_heap);
         free_xenheap_page(gt->status[i]);
         gt->status[i] = NULL;
     }
