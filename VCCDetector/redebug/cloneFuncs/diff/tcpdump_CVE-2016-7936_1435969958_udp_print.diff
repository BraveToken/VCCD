--- udp_print_OLD.c	2021-12-07 00:03:19.564315400 +0800
+++ udp_print_NEW.c	2021-12-07 00:03:19.564315400 +0800
@@ -26,6 +26,11 @@
 	sport = EXTRACT_16BITS(&up->uh_sport);
 	dport = EXTRACT_16BITS(&up->uh_dport);
 
+	if (!ND_TTEST(up->uh_ulen)) {
+		udpipaddr_print(ndo, ip, sport, dport);
+		ND_PRINT((ndo, "[|udp]"));
+		return;
+	}
 	if (length < sizeof(struct udphdr)) {
 		udpipaddr_print(ndo, ip, sport, dport);
 		ND_PRINT((ndo, "truncated-udp %d", length));
