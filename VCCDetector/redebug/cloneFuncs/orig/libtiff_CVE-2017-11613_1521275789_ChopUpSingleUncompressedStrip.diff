--- ChopUpSingleUncompressedStrip_OLD.c	2021-12-06 23:26:54.479488400 +0800
+++ ChopUpSingleUncompressedStrip_NEW.c	2021-12-06 23:26:54.479488400 +0800
@@ -56,9 +56,8 @@
         /* file is as big as needed */
         if( tif->tif_mode == O_RDONLY &&
             nstrips > 1000000 &&
-            (tif->tif_dir.td_stripoffset[0] >= TIFFGetFileSize(tif) ||
-             tif->tif_dir.td_stripbytecount[0] >
-                    TIFFGetFileSize(tif) - tif->tif_dir.td_stripoffset[0]) )
+            (offset >= TIFFGetFileSize(tif) ||
+             stripbytes > (TIFFGetFileSize(tif) - offset) / (nstrips - 1)) )
         {
             return;
         }
