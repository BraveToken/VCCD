--- ppp_hdlc_if_print_OLD.c	2021-12-07 00:03:16.170379800 +0800
+++ ppp_hdlc_if_print_NEW.c	2021-12-07 00:03:16.170379800 +0800
@@ -40,6 +40,11 @@
 		return (chdlc_if_print(ndo, h, p));
 
 	default:
+		if (caplen < 4) {
+			ND_PRINT((ndo, "[|ppp]"));
+			return (caplen);
+		}
+
 		if (ndo->ndo_eflag)
 			ND_PRINT((ndo, "%02x %02x %d ", p[0], p[1], length));
 		p += 2;
