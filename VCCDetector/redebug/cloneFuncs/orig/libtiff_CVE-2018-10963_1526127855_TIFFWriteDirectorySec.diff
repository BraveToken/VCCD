--- TIFFWriteDirectorySec_OLD.c	2021-12-06 23:27:12.240982900 +0800
+++ TIFFWriteDirectorySec_NEW.c	2021-12-06 23:27:12.241980700 +0800
@@ -335,8 +335,11 @@
 								}
 								break;
 							default:
-								assert(0);   /* we should never get here */
-								break;
+								TIFFErrorExt(tif->tif_clientdata,module,
+								            "Cannot write tag %d (%s)",
+								            TIFFFieldTag(o),
+                                                                            o->field_name ? o->field_name : "unknown");
+								goto bad;
 						}
 					}
 				}
