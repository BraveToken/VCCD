--- hvmemul_vmfunc_OLD.c	2021-12-07 00:14:44.751714000 +0800
+++ hvmemul_vmfunc_NEW.c	2021-12-07 00:14:44.751714000 +0800
@@ -3,6 +3,8 @@
 {
     int rc;
 
+    if ( !hvm_funcs.altp2m_vcpu_emulate_vmfunc )
+        return X86EMUL_UNHANDLEABLE;
     rc = hvm_funcs.altp2m_vcpu_emulate_vmfunc(ctxt->regs);
     if ( rc != X86EMUL_OKAY )
         x86_emul_hw_exception(TRAP_invalid_op, X86_EVENT_NO_EC, ctxt);
