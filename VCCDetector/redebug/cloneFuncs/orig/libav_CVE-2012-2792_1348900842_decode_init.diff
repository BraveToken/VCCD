--- decode_init_OLD.c	2021-12-06 23:23:08.743239900 +0800
+++ decode_init_NEW.c	2021-12-06 23:23:08.743239900 +0800
@@ -44,6 +44,7 @@
     /* get frame len */
     s->samples_per_frame = 1 << ff_wma_get_frame_len_bits(avctx->sample_rate,
                                                           3, s->decode_flags);
+    av_assert0(s->samples_per_frame <= WMALL_BLOCK_MAX_SIZE);
 
     /* init previous block len */
     for (i = 0; i < avctx->channels; i++)
