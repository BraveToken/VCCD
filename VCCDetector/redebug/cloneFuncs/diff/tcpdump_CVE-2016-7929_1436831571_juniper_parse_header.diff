--- juniper_parse_header_OLD.c	2021-12-07 00:03:06.015518200 +0800
+++ juniper_parse_header_NEW.c	2021-12-07 00:03:06.015518200 +0800
@@ -61,9 +61,11 @@
             tlv_len = *(tptr++);
             tlv_value = 0;
 
-            /* sanity check */
+            /* sanity checks */
             if (tlv_type == 0 || tlv_len == 0)
                 break;
+            if (tlv_len+JUNIPER_EXT_TLV_OVERHEAD > jnx_ext_len)
+                goto trunc;
 
             if (ndo->ndo_vflag > 1)
                 ND_PRINT((ndo, "\n\t  %s Extension TLV #%u, length %u, value ",
