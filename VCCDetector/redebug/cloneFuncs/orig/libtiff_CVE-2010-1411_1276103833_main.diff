--- main_OLD.c	2021-12-06 23:25:20.079967600 +0800
+++ main_NEW.c	2021-12-06 23:25:20.079967600 +0800
@@ -122,11 +122,14 @@
 	for (; optind < argc-1 ; optind++) {
 		char *imageCursor = argv[optind];
 		in = openSrcImage (&imageCursor);
-		if (in == NULL)
+		if (in == NULL) {
+			(void) TIFFClose(out);
 			return (-3);
+		}
 		if (diroff != 0 && !TIFFSetSubDirectory(in, diroff)) {
 			TIFFError(TIFFFileName(in),
 			    "Error, setting subdirectory at " TIFF_UINT64_FORMAT, diroff);
+			(void) TIFFClose(in);
 			(void) TIFFClose(out);
 			return (1);
 		}
@@ -140,7 +143,8 @@
 			tilelength = deftilelength;
 			g3opts = defg3opts;
 			if (!tiffcp(in, out) || !TIFFWriteDirectory(out)) {
-				TIFFClose(out);
+				(void) TIFFClose(in);
+				(void) TIFFClose(out);
 				return (1);
 			}
 			if (imageCursor) { /* seek next image directory */
@@ -148,9 +152,9 @@
 			}else
 				if (!TIFFReadDirectory(in)) break;
 		}
-		TIFFClose(in);
+		(void) TIFFClose(in);
 	}
 
-	TIFFClose(out);
+	(void) TIFFClose(out);
 	return (0);
 }
