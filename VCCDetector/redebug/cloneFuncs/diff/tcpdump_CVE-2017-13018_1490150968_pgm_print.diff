--- pgm_print_OLD.c	2021-12-07 00:05:42.018303800 +0800
+++ pgm_print_NEW.c	2021-12-07 00:05:42.019300200 +0800
@@ -313,6 +313,10 @@
 		    ND_PRINT((ndo, "[Total option length leaves no room for final option]"));
 		    return;
 		}
+		if (!ND_TTEST2(*bp, 2)) {
+		    ND_PRINT((ndo, " [|OPT]"));
+		    return;
+		}
 		opt_type = *bp++;
 		opt_len = *bp++;
 		if (opt_len < PGM_MIN_OPT_LEN) {
