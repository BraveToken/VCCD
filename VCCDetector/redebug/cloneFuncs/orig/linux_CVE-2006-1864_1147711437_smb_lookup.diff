--- smb_lookup_OLD.c	2021-12-06 23:28:21.801936000 +0800
+++ smb_lookup_NEW.c	2021-12-06 23:28:21.801936000 +0800
@@ -10,6 +10,11 @@
 	if (dentry->d_name.len > SMB_MAXNAMELEN)
 		goto out;
 
+	/* Do not allow lookup of names with backslashes in */
+	error = -EINVAL;
+	if (memchr(dentry->d_name.name, '\\', dentry->d_name.len))
+		goto out;
+
 	lock_kernel();
 	error = smb_proc_getattr(dentry, &finfo);
 #ifdef SMBFS_PARANOIA
