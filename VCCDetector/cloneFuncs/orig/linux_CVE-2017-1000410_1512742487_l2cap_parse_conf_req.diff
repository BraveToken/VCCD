--- l2cap_parse_conf_req_OLD.c	2021-12-06 23:38:46.424328800 +0800
+++ l2cap_parse_conf_req_NEW.c	2021-12-06 23:38:46.424328800 +0800
@@ -45,9 +45,10 @@
 			break;
 
 		case L2CAP_CONF_EFS:
-			remote_efs = 1;
-			if (olen == sizeof(efs))
+			if (olen == sizeof(efs)) {
+				remote_efs = 1;
 				memcpy(&efs, (void *) val, olen);
+			}
 			break;
 
 		case L2CAP_CONF_EWS:
