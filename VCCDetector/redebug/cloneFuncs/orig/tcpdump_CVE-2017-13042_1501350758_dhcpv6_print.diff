--- dhcpv6_print_OLD.c	2021-12-07 00:06:55.192594600 +0800
+++ dhcpv6_print_NEW.c	2021-12-07 00:06:55.192594600 +0800
@@ -8,6 +8,8 @@
 
     i = 0;
     while (i < length) {
+        if (i + 4 > length)
+            return -1;
         tlv = cp + i;
         type = EXTRACT_16BITS(tlv);
         optlen = EXTRACT_16BITS(tlv + 2);
@@ -19,6 +21,8 @@
 
         ND_PRINT((ndo, "%s", tok2str(dh6opt_str, "Unknown", type)));
         ND_PRINT((ndo," (%u)", optlen + 4 ));
+        if (i + 4 + optlen > length)
+            return -1;
 
         switch (type) {
             case DH6OPT_DNS_SERVERS:
