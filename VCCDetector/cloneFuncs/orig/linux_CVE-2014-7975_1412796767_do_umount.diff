--- do_umount_OLD.c	2021-12-06 23:35:48.605918000 +0800
+++ do_umount_NEW.c	2021-12-06 23:35:48.606915300 +0800
@@ -61,6 +61,8 @@
 		 * Special case for "unmounting" root ...
 		 * we just try to remount it readonly.
 		 */
+		if (!capable(CAP_SYS_ADMIN))
+			return -EPERM;
 		down_write(&sb->s_umount);
 		if (!(sb->s_flags & MS_RDONLY))
 			retval = do_remount_sb(sb, MS_RDONLY, NULL, 0);
