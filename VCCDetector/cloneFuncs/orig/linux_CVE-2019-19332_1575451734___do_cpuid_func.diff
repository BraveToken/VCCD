--- __do_cpuid_func_OLD.c	2021-12-06 23:44:31.480443100 +0800
+++ __do_cpuid_func_NEW.c	2021-12-06 23:44:31.480443100 +0800
@@ -76,7 +76,7 @@
 
 	r = -E2BIG;
 
-	if (*nent >= maxnent)
+	if (WARN_ON(*nent >= maxnent))
 		goto out;
 
 	do_host_cpuid(entry, function, 0);
