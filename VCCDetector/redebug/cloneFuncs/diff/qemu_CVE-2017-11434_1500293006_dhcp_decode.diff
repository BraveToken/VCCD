--- dhcp_decode_OLD.c	2021-12-06 23:59:50.702899400 +0800
+++ dhcp_decode_NEW.c	2021-12-06 23:59:50.703896900 +0800
@@ -23,6 +23,9 @@
             if (p >= p_end)
                 break;
             len = *p++;
+            if (p + len > p_end) {
+                break;
+            }
             DPRINTF("dhcp: tag=%d len=%d\n", tag, len);
 
             switch(tag) {
