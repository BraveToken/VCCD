--- ec_dev_ioctl_OLD.c	2021-12-06 23:30:43.136924000 +0800
+++ ec_dev_ioctl_NEW.c	2021-12-06 23:30:43.136924000 +0800
@@ -23,6 +23,9 @@
 	err = 0;
 	switch (cmd) {
 	case SIOCSIFADDR:
+		if (!capable(CAP_NET_ADMIN))
+			return -EPERM;
+
 		edev = dev->ec_ptr;
 		if (edev == NULL) {
 			/* Magic up a new one. */
