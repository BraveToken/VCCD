--- hid_register_report_OLD.c	2021-12-06 23:32:54.616271800 +0800
+++ hid_register_report_NEW.c	2021-12-06 23:32:54.616271800 +0800
@@ -3,6 +3,8 @@
 	struct hid_report_enum *report_enum = device->report_enum + type;
 	struct hid_report *report;
 
+	if (id >= HID_MAX_IDS)
+		return NULL;
 	if (report_enum->report_id_hash[id])
 		return report_enum->report_id_hash[id];
 
