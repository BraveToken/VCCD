--- llcp_sock_connect_OLD.c	2021-12-06 23:47:04.390490600 +0800
+++ llcp_sock_connect_NEW.c	2021-12-06 23:47:04.390490600 +0800
@@ -61,6 +61,7 @@
 	llcp_sock->ssap = nfc_llcp_get_local_ssap(local);
 	if (llcp_sock->ssap == LLCP_SAP_MAX) {
 		nfc_llcp_local_put(llcp_sock->local);
+		llcp_sock->local = NULL;
 		ret = -ENOMEM;
 		goto put_dev;
 	}
@@ -108,6 +109,7 @@
 sock_llcp_release:
 	nfc_llcp_put_ssap(local, llcp_sock->ssap);
 	nfc_llcp_local_put(llcp_sock->local);
+	llcp_sock->local = NULL;
 
 put_dev:
 	nfc_put_device(dev);
