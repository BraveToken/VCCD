--- populate_physmap_OLD.c	2021-12-07 00:09:46.279000400 +0800
+++ populate_physmap_NEW.c	2021-12-07 00:09:46.279994600 +0800
@@ -25,7 +25,8 @@
 
         if ( a->memflags & MEMF_populate_on_demand )
         {
-            if ( guest_physmap_mark_populate_on_demand(d, gpfn,
+            if ( a->extent_order > MAX_ORDER ||
+                 guest_physmap_mark_populate_on_demand(d, gpfn,
                                                        a->extent_order) < 0 )
                 goto out;
         }
