--- lookup_create_plock_ctx_OLD.c	2021-12-07 00:02:02.313929700 +0800
+++ lookup_create_plock_ctx_NEW.c	2021-12-07 00:02:02.314919800 +0800
@@ -4,7 +4,6 @@
                                                       pid_t pid, int *err)
 {
     struct lo_inode_plock *plock;
-    char procname[64];
     int fd;
 
     plock =
@@ -21,12 +20,10 @@
     }
 
     /* Open another instance of file which can be used for ofd locks. */
-    sprintf(procname, "%i", inode->fd);
-
     /* TODO: What if file is not writable? */
-    fd = openat(lo->proc_self_fd, procname, O_RDWR);
-    if (fd == -1) {
-        *err = errno;
+    fd = lo_inode_open(lo, inode, O_RDWR);
+    if (fd < 0) {
+        *err = -fd;
         free(plock);
         return NULL;
     }
