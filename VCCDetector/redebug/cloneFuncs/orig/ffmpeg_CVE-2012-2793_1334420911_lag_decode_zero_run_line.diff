--- lag_decode_zero_run_line_OLD.c	2021-12-06 23:19:19.050598600 +0800
+++ lag_decode_zero_run_line_NEW.c	2021-12-06 23:19:19.050598600 +0800
@@ -13,6 +13,11 @@
 output_zeros:
     if (l->zeros_rem) {
         count = FFMIN(l->zeros_rem, width - i);
+        if (end - dst < count) {
+            av_log(l->avctx, AV_LOG_ERROR, "Too many zeros remaining.\n");
+            return AVERROR_INVALIDDATA;
+        }
+
         memset(dst, 0, count);
         l->zeros_rem -= count;
         dst += count;
