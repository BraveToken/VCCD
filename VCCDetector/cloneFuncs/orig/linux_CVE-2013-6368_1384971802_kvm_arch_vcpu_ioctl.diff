--- kvm_arch_vcpu_ioctl_OLD.c	2021-12-06 23:34:10.400580100 +0800
+++ kvm_arch_vcpu_ioctl_NEW.c	2021-12-06 23:34:10.400580100 +0800
@@ -123,8 +123,7 @@
 		r = -EFAULT;
 		if (copy_from_user(&va, argp, sizeof va))
 			goto out;
-		r = 0;
-		kvm_lapic_set_vapic_addr(vcpu, va.vapic_addr);
+		r = kvm_lapic_set_vapic_addr(vcpu, va.vapic_addr);
 		break;
 	}
 	case KVM_X86_SETUP_MCE: {
